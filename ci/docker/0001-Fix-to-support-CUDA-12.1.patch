From 77dc5a41476b9671193559ac666f7a3affaa872d Mon Sep 17 00:00:00 2001
From: Malcolm Greaves <mgreaves@nvidia.com>
Date: Fri, 15 Nov 2024 03:53:16 +0000
Subject: [PATCH] Fix to support CUDA 12.1

---
 transformer_engine/pytorch/csrc/userbuffers/userbuffers.cu | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

diff --git a/transformer_engine/pytorch/csrc/userbuffers/userbuffers.cu b/transformer_engine/pytorch/csrc/userbuffers/userbuffers.cu
index f98688b..c3cc7a6 100644
--- a/transformer_engine/pytorch/csrc/userbuffers/userbuffers.cu
+++ b/transformer_engine/pytorch/csrc/userbuffers/userbuffers.cu
@@ -5,6 +5,7 @@
  ************************************************************************/

 #include <cuda.h>
+#include <cuda_fp8.h>
 #include <cuda_runtime.h>

 #if __CUDA_ARCH__ >= 800
@@ -19,7 +20,6 @@
 #include <unistd.h>
 #include <stdio.h>
 #include <assert.h>
-#include <cuda_fp8.h>

 #define MAX_THREADS 1024

--
2.25.1
